将进度条的样式修改一下：

并且看一下之前是怎么实现的上传，以及看一下微信的安卓的那个函数是否可以使用了，如果不能，那就继续这样子实现。

为了实现图片的拖拽，控制了一个`overflow:hidden;position:fixed`

这个链式写法呀，值得学习：

```
wx.createSelectorQuery().select('.albumView').boundingClientRect(rect => {
    this.albumOffset = rect.top
}).exec()
```

了解一下这里的个人数据是怎么修改的：

一般的数据使用的是接口上传，图片使用的是阿里云的上传。

在使用阿里云上传的时候会先通过接口去获取一些token验证之类的值，然后再调用阿里云的上传。

图片上传的时候只会上传新的图片，以前的图片不会上传

用户如果删除图片，那么并不会删除以前的图片，只是展示的时候会展示部分图片而已。

上传图片到阿里云成功之后还得

关于个人数据修改这里的一些高级的写法：

```
 let [requestData, modifyRequest] = this.buildRequest()
```

这是变量的解构赋值里边的对象的解构赋值方法。

一个问题：`JSON.stringify`的作用是什么？把一个数组这样子做一个跟另外一个数组进行比较？对，这样子直接使用==就可以确定是否相等了。

写一个图片上传进度组件======

不使用progress组件是因为希望颜色是渐变的颜色

现在需要再一次写一个组件：可是我基本上都忘了怎么写了，😭。那就再看一遍文档吧：

1、组件名称可以不跟文件夹的名称相同。

2、

这个组件只需要两个数据，那就是百分比&是否可以使用百分比，以及两个方法，显示和隐藏组件的方法。

监听器如果可以用那么就更好了，但是现在的监听器需要的版本比较高。

`showLoading`不会主动消失除非调用`hideLoading`

现在的问题就是怎么把百分比的数据传到页面上。。。。。。想了一个通过page传递的方法。

而且这个进度条会在两个页面用到，所以应该把另外一个页面也引入这个组件。

我有点懵，怎么就不执行aliyun的上传方法了呢！！！

```
"usingComponents": {
    "up-progress": "../../components/up-progress/index"
        "up-progress": "../../components/up-progress/index",
  }
```

而且是没有组件的时候执行这个方法，有了组件就不执行方法====

一个比较可疑的配置：

```
"navigationStyle": "custom"
```

排除是我组件写的有问题：证明了不是我组件写的有问题，而是这个页面有问题

想着不用组件了，那让效果好一点用个`template`总行吧，结果是可以的，因为刚刚忘了把`usingComponents`去掉。

现在需要的就是看一下数据是怎么计算的，以及更新的那个函数行不行，如果ok就使用，不ok就继续用现在这个。

查了一下微信公众平台社区：[https://developers.weixin.qq.com/community/develop/doc/000e06415e8080732868e776f56000?highLine=onProgressUpdate](https://developers.weixin.qq.com/community/develop/doc/000e06415e8080732868e776f56000?highLine=onProgressUpdate) 有人提出了这个问题，然后官方给出的回答是：[http://mrpeak.cn/blog/http-upload-progress/](http://mrpeak.cn/blog/http-upload-progress/)  确实[Http文件上传进度为什么不准  ](http://mrpeak.cn/blog/http-upload-progress/)

它的意思是不仅仅是微信这里不准，其他的也都不准，这是http机制的问题。

现在只剩下了一个问题，那就是数据怎么计算的+ complete那个页面样式。

得先实现了再说选择哪一种：

重要的不是样式，是那个流畅的效果。不是突然的变多，而是慢慢的滑动到那一部分。

所以需要实现的就两个点，一个是动画，另一个是判断当前的进度到哪里了，以及去掉之前的框。

animation的第二个属性是动画持续的时间。

一个问题：动画只有第一次赋值的时候有效果，后来就么有效果了。

一开始就给一个动画效果，让进度条慢慢的走到50%，然后如果再有真实的进展了，那么这时候再把宽度慢慢变长，但是变长的过程中是需要有动画效果的，而不是突然就变长。如果很快的就结束了，那么也不要让用户那么快就上传完，而是给一个缓慢上传的过程。

使用一个滑块往右滑动的方法不行，因为是渐变色，如果想要渐变的好，那么这个策略就不行【X】

找到的一堆实现进度条的方式：

1、使用progress没有渐变色：

```js
<progress percent="{{progress}}" show-info="true" color="red" 
stroke-width="50" activeColor="green" backgroundColor="#ccc" />
var progressNum =0; //定义一个初始值0

//onLoad当页面加载时执行的方法
onLoad:function(e){
// progressNum
var that = this;
var timer = setInterval(function(){
    progressNum++;
    //当进度条为100时清除定时任务
    if (progressNum >= 100) clearInterval(timer);

    //并且把当前的进度值设置到progress中
    that.setData({progress: progressNum})
})
}
```

这个的结果是页面一进来就加载，然后值从0到100，赋值一百次。其实并不咋地，也没难度。也没思想

2、通过计算css动画持续时间来计算间隔时间。

这个真是一个宝呀，即使通过setInterval设置了width已经到了最大值，但是动画会慢慢的执行过去

目前最大的问题就是动画没有办法从上一个地方结束的地方连着播，但是progress有这么一个设置，动画从上次播到的地方接着播。

感觉现在从一般的网页上已经找不到我想要的效果了，因为要求比较高=====

想要把渐变改好那么就得知道百分比代表什么意思。

如何手动计算渐变色变了多少？如果有角度的情况下要怎么计算？

我以为不能实现渐变，可是现在才发现是理解不够清除，当把颜色放在某个地方之后，渐变就实现了，原来动画只是决定一个缓动的效果。并不决定其他，包括背景色

### **如果需要手动写动画，你认为最小时间间隔是多久，为什么？**

多数显示器默认频率是60Hz，即1秒刷新60次，所以理论上最小间隔为1/60＊1000ms ＝ 16.7ms

所以如果跟刷新次数差不多的话，那么就会看不出来是在赋值没有动画，因为页面一直在刷新，但是我们肉眼看不出来。

出现了一个问题，为什么会闪一下？？？？

寻找一个让它不闪的方式，比如ease-in - out啥的？

一个跟预期不一样的体验：不设置宽度的时候，即使设置了渲染到50%那么也会渲染到100%，这是为啥？果然是设置的某些css的问题，是因为对继承宽高的认识不到位吧，当设置了relative和absolute之后，就不会继承默认的100%的宽了。

`animation-fill-mode: forwards;`也是十分有用的，会保留在上一次渲染结束的那个点，不然的话宽度就会重新置为渲染开始的那个点。

我的妈呀，我太开心了，终于实现了不卡顿的流畅的动画的效果了。

缺点是百分比并没有挨着变，因为那样setData太频繁了，感觉并不好。

试了一下加上了这个`animation-fill-mode: forwards;`属性的是不是可以接着渲染，发现不行，会变成从0-50，0-60这样子的。

现在设置的修改资料的时长是2.5s,基本上应该没啥问题了吧，毕竟这么长。

如果修改资料失败，那么就会出现框闪一下立刻消失，然后出现错误提醒的情况。

如果同时有修改和上传，那么会先显示出来修改再显示上传。

先解决如果只有上传照片的这个：======

试一下如果使用两个interval会咋样？？？



问题出现



